<!DOCTYPE HTML>
<html>
    <head>
        <meta lang="en">
        
        <!-- Show loading screen immediately -->
        <style>
            /* Inline critical styles for immediate loading screen display */
            #loading-overlay {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                z-index: 9999;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                font-family: 'Arial', sans-serif;
            }
            
            .loading-logo {
                margin-bottom: 30px;
                animation: logoFloat 3s ease-in-out infinite;
            }
            
            .loading-logo img {
                height: 120px;
                width: auto;
                filter: drop-shadow(0 8px 16px rgba(0,0,0,0.3));
                border-radius: 12px;
                background: rgba(255,255,255,0.9);
                padding: 15px;
            }
            
            .loading-text {
                color: white;
                font-size: 24px;
                font-weight: 600;
                margin-bottom: 20px;
                text-shadow: 0 2px 4px rgba(0,0,0,0.3);
                animation: textPulse 2s ease-in-out infinite;
            }
            
            .loading-spinner {
                width: 50px;
                height: 50px;
                border: 4px solid rgba(255,255,255,0.3);
                border-top: 4px solid #ffffff;
                border-radius: 50%;
                animation: spin 1s linear infinite;
                margin-bottom: 20px;
            }
            
            .progress-container {
                width: 300px;
                height: 6px;
                background: rgba(255,255,255,0.2);
                border-radius: 10px;
                overflow: hidden;
            }
            
            .progress-bar {
                height: 100%;
                background: linear-gradient(90deg, #00d4aa, #00a8ff);
                border-radius: 10px;
                animation: progressLoad 5s ease-in-out infinite;
            }
            
            .loading-message {
                color: rgba(255,255,255,0.8);
                font-size: 14px;
                margin-top: 15px;
                text-align: center;
                animation: messageFade 4s ease-in-out infinite;
            }
            
            @keyframes logoFloat {
                0%, 100% { transform: translateY(0px); }
                50% { transform: translateY(-10px); }
            }
            
            @keyframes textPulse {
                0%, 100% { opacity: 1; }
                50% { opacity: 0.7; }
            }
            
            @keyframes spin {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
            }
            
            @keyframes progressLoad {
                0% { width: 0%; }
                25% { width: 30%; }
                50% { width: 60%; }
                75% { width: 85%; }
                100% { width: 100%; }
            }
            
            @keyframes messageFade {
                0%, 100% { opacity: 0.8; }
                25% { opacity: 1; }
                75% { opacity: 0.6; }
            }
            
            #loading-overlay.fade-out {
                opacity: 0;
                transition: opacity 0.8s ease-out;
            }
        </style>
        
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
        crossorigin=""/>
        <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
        crossorigin=""></script>
        <script src="https://unpkg.com/geojson-vt/geojson-vt.js"></script>
        <script src="static/leaflet-geojson-vt.js"></script> 
        <link rel="stylesheet" href="static/css/style.css">
        <script src="static/js/templates.js"></script>
        <script src="static/js/zipToZip.js"></script>
        <script src="static/js/zipcodeSuggestions.js"></script>
        <script src="static/js/form2Integration.js"></script>
        <script src="static/script.js" defer></script>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.1/umd/popper.min.js"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
        <link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css" />
        <script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>
        <link rel="stylesheet" href="https://unpkg.com/@geoman-io/leaflet-geoman-free@latest/dist/leaflet-geoman.css"/> 
        <script src="https://unpkg.com/@geoman-io/leaflet-geoman-free@latest/dist/leaflet-geoman.js"></script> 
    </head>
    <body>
        <div id="map"></div>

        <!-- <section class="routing-menu"> -->
            <!-- <div class="start-container btn-group dropright">
                    <button type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Start
                    </button> -->

            <!-- <div class="dropdown-menu"></div>
            </div>
            <div class="layer-container start"></div>
            <div class="end-container btn-group dropright">
                <button type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            End
                </button>
                    <div class="dropdown-menu">
                 Dropdown menu links
                    </div>
            </div>
            <div class="layer-container end"></div>

            <button type="button" class="routing-button">Get Route</button>
        </section>  -->

        <section class="routing-tab">
                <!-- File Upload Section (Initially Hidden) -->
                <section class="droparea" id="file-upload-section" style="display: none;">
                    <p>Drop a GEOJSON file here</p>
                    <label for="file" class="custom-file-upload">
                        Browse File
                    </label>
                    <input type="file" id="file"  name="file" accept="*.geojson" />
                </section>

                <!--<section class="route-box file-input">
                    <span>
                        <label for="file"> Upload File
                        <input type="file">Start
                    </span>
                    <span>
                        <label for="file"> Upload File
                        <input type="file">End
                    </span>
                    <button>GET ROUTE</button>
                </section> -->

                <!-- Routing Mode Selector for Address/Zipcode Form -->
                <section class="route-box routing-mode-section">
                    <!-- Toggle Switch for File Upload Section -->
                    <section class="toggle-section">
                        <div class="toggle-container">
                            <div class="toggle-switch">
                                <input type="checkbox" id="file-upload-toggle" class="toggle-input">
                                <label for="file-upload-toggle" class="toggle-label">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                        </div>
                    </section>
                    <div class="routing-mode-selector-alt">
                        <select id="routing-mode-alt" class="routing-mode-dropdown-alt">
                            <option value="" disabled selected>Routing Mode:</option>
                            <option value="multiple">Multiple Destinations</option>
                            <option value="roundtrip">Round Trip</option>
                        </select>
                    </div>
                </section>
             
                <section class="route-box text-input">
                     <span class="box-span-start">
                        <span>Add starting zipcode or address</span>
                        <div class="checkbox-container">
                            <input type="radio" id="address" name="start"/>
                            <label for="address">Address</label>
                            <input type="radio" id="zipcode" name="start"/>
                            <label for="zipcode">Zipcode</label>
                        </div>
                        <div class="start-input"></div>

              </span>


                    <span class="box-span-end">
                        <span>Add finish zipcode or address</span>
                        <div class="checkbox-container">
                            <input type="radio" id="address" name="end"/>
                            <label for="address">Address</label>
                            <input type="radio" id="zipcode" name="end"/>
                            <label for="zipcode">Zipcode</label>
                        </div>
                        <div class="end-input"></div>
                    </span>


                    <button class="query-btn">GET ROUTE</button>
                </section>
            </section>
           


        <section class="table-view">
        </section>

        <!-- Add this new section for attribute tables -->
        <section class="attribute-table-container" style="display: none;">
        </section>

        <!-- Loading Screen - Shows immediately -->
        <div id="loading-overlay">
            <!-- Logo Container -->
            <div class="loading-logo">
                <img src="static/LOGO.png" alt="GIS Solutions">
            </div>
            
            <!-- Loading Text -->
            <div class="loading-text">
                Loading Application...
            </div>
            
            <!-- Loading Spinner -->
            <div class="loading-spinner"></div>
            
            <!-- Progress Bar -->
            <div class="progress-container">
                <div class="progress-bar"></div>
            </div>
            
            <!-- Loading Message -->
            <div class="loading-message" id="loading-status">
                Initializing GIS routing platform...
            </div>
        </div>

        <script>
        // Track resource loading progress
        let resourcesLoaded = 0;
        let totalResources = 0;
        let loadingMessages = [
            'Loading Leaflet mapping library...',
            'Loading GeoJSON utilities...',
            'Loading Bootstrap framework...',
            'Loading jQuery libraries...',
            'Loading geocoding services...',
            'Loading drawing tools...',
            'Initializing application scripts...',
            'Setting up routing platform...',
            'Almost ready...',
            'Application ready!'
        ];
        
        function updateLoadingStatus(message) {
            const statusElement = document.getElementById('loading-status');
            if (statusElement) {
                statusElement.textContent = message;
            }
        }
        
        function hideLoadingScreen() {
            const loadingOverlay = document.getElementById('loading-overlay');
            
            // Show final message
            updateLoadingStatus('Application ready!');
            
            setTimeout(function() {
                loadingOverlay.classList.add('fade-out');
                
                // Remove the loading overlay after fade-out animation completes
                setTimeout(function() {
                    loadingOverlay.style.display = 'none';
                }, 800); // Match the CSS transition duration
            }, 500);
        }
        
        // Wait for all critical resources to load
        document.addEventListener("DOMContentLoaded", function() {
            updateLoadingStatus('DOM loaded, initializing components...');
        });
        
        // Wait for all resources including images, stylesheets, scripts
        window.addEventListener('load', function() {
            updateLoadingStatus('All resources loaded, starting application...');
            
            // Small delay to ensure all scripts are executed
            setTimeout(function() {
                hideLoadingScreen();
            }, 1000);
        });
        
        // Progressive loading status updates
        let messageIndex = 0;
        const messageInterval = setInterval(function() {
            if (messageIndex < loadingMessages.length - 1) {
                updateLoadingStatus(loadingMessages[messageIndex]);
                messageIndex++;
            }
        }, 800);
        
        // Clean up interval when loading is complete
        window.addEventListener('load', function() {
            setTimeout(function() {
                clearInterval(messageInterval);
            }, 1000);
        });
        </script>
    </body>

</html>